<div class="row" id="global_filters">

	<div class="col-md-12 text-right" style="margin-bottom:10px">
		<div class="btn-group">
    	<button type="button" class="btn btn-xs btn-default" id="chaos">
				<span class="fa fa-random"></span> Chaos</span>
			</button>
		</div>
		<div class="btn-group" id="aspect_selector">
			<button type="button" class="btn btn-xs btn-default dropdown-toggle " data-toggle="dropdown">
				<span class="hidden-xs">Change Aspect</span> <span class="caret"></span>
			</button>
			<ul class="dropdown-menu" role="menu" id="menu-aspect">
				<li><a href="#" onclick="app.deck.change_aspect('leadership')" id="btn-sort-default"><span class="fa fa-circle fg-leadership"></span> Leadership</a></li>
				<li><a href="#" onclick="app.deck.change_aspect('protection')" id="btn-sort-name"><span class="fa fa-circle fg-protection"></span> Protection</span></a></li>
				<li><a href="#" onclick="app.deck.change_aspect('justice')" id="btn-sort-position"><span class="fa fa-circle fg-justice"></span> Justice</a></li>
				<li><a href="#" onclick="app.deck.change_aspect('aggression')" id="btn-sort-position"><span class="fa fa-circle fg-aggression"></span> Aggression</a></li>
				<li><a href="#" onclick="app.deck.change_aspect('pool')" id="btn-sort-position"><span class="fa fa-circle fg-pool"></span> 'Pool</a></li>
				<li><a href="#" onclick="app.deck.change_aspect('determination')" id="btn-sort-position"><span class="fa fa-circle fg-determination"></span> Determination</a></li>
			</ul>
		</div>

		<div class="btn-group" id="aspect2_selector">
			<button type="button" class="btn btn-xs btn-default dropdown-toggle " data-toggle="dropdown">
				<span class="hidden-xs">Change Aspect 2</span> <span class="caret"></span>
			</button>
			<ul class="dropdown-menu" role="menu" id="menu-aspect2">
				<li><a href="#" onclick="app.deck.change_aspect2('leadership')" id="btn-sort-default"><span class="fa fa-circle fg-leadership"></span> Leadership</a></li>
				<li><a href="#" onclick="app.deck.change_aspect2('protection')" id="btn-sort-name"><span class="fa fa-circle fg-protection"></span> Protection</span></a></li>
				<li><a href="#" onclick="app.deck.change_aspect2('justice')" id="btn-sort-position"><span class="fa fa-circle fg-justice"></span> Justice</a></li>
				<li><a href="#" onclick="app.deck.change_aspect2('aggression')" id="btn-sort-position"><span class="fa fa-circle fg-aggression"></span> Aggression</a></li>
				<li><a href="#" onclick="app.deck.change_aspect2('pool')" id="btn-sort-position"><span class="fa fa-circle fg-pool"></span> 'Pool</a></li>
				<li><a href="#" onclick="app.deck.change_aspect2('determination')" id="btn-sort-position"><span class="fa fa-circle fg-determination"></span> Determination</a></li>
			</ul>
		</div>

		<div class="btn-group">
			<button type="button" class="btn btn-xs btn-default dropdown-toggle " data-toggle="dropdown">
				<span class="fa fa-sort"></span> <span class="hidden-xs">Sort Deck</span> <span class="caret"></span>
			</button>
			<ul class="dropdown-menu" role="menu" id="menu-sort">
				<li><a href="#" onclick="app.deck.change_sort('default')" id="btn-sort-default">by Type</a></li>
				<li><a href="#" onclick="app.deck.change_sort('name')" id="btn-sort-name">by Name</a></li>
				<li><a href="#" onclick="app.deck.change_sort('set')" id="btn-sort-position">by Set, then Name</a></li>
				<li><a href="#" onclick="app.deck.change_sort('setnumber')" id="btn-sort-position">by Set, then Number</a></li>
				<li><a href="#" onclick="app.deck.change_sort('faction')" id="btn-sort-faction">by Aspect, then Name</a></li>
				<li><a href="#" onclick="app.deck.change_sort('factionnumber')" id="btn-sort-faction">by Aspect, then Number</a></li>
				<li><a href="#" onclick="app.deck.change_sort('number')" id="btn-sort-faction">by Card Number</a></li>
				<li><a href="#" onclick="app.deck.change_sort('cost')" id="btn-sort-faction">by Cost</a></li>
			</ul>
		</div>

		<div class="btn-group">
			<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown">Pack Filter <span class="caret"></span></button>
			<ul class="dropdown-menu pull-right" data-filter="pack_code" title="Shift+Click to select only one option ; Alt+Shift+Click to select all other options"></ul>
		</div>
		<div class="btn-group">
			<div class="dropdown dropdown-btn">
			<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown">Options <span class="caret"></span></button>
				<ul class="dropdown-menu pull-right" id="config-options">
					<li><a href="#"><label><input type="checkbox" name="show-unusable"> Show unusable cards</label></a></li>
					<li><a href="#"><label><input type="checkbox" name="show-only-deck"> Show only used cards</label></a></li>
					<li><a href="#"><label><input type="radio" name="display-column" value="1"> Display on 1 column</label></a></li>
					<li><a href="#"><label><input type="radio" name="display-column" value="2"> Display on 2 columns</label></a></li>
					<li><a href="#"><label><input type="radio" name="display-column" value="3"> Display on 3 columns</label></a></li>
					<li><a href="#"><label><input type="radio" name="show-suggestions" value="0"> Show no suggestion</label></a></li>
					<li><a href="#"><label><input type="radio" name="show-suggestions" value="3"> Show 3 suggestions</label></a></li>
					<li><a href="#"><label><input type="radio" name="show-suggestions" value="10"> Show 10 suggestions</label></a></li>
					<li><a href="#"><label><input type="radio" name="buttons-behavior" value="cumulative"> Aspect/type cumulative</label></a></li>
					<li><a href="#"><label><input type="radio" name="buttons-behavior" value="exclusive"> Aspect/type exclusive</label></a></li>
				</ul>
			</div>
		</div><!-- /.btn-group -->
		<button class="btn btn-default btn-xs" type="button" id="filter-text-button">Filter help</button>
	</div><!-- /.col-sm-6 -->
</div><!-- /.row -->

<div class="row" id="build_filters">

	<div class="col-sm-12" style="margin-bottom:10px">
			<!-- Hidden inputs kept for backward compatibility with existing JS that listens to change on these IDs -->
			<input type="checkbox" id="show-fanmade-affinity" checked style="display:none;">
			<strong style="font-weight:700; margin-right:8px;">Additional Filters</strong>
			<button type="button" id="btn-show-fanmade" class="btn btn-xs active" style="margin-right:6px;">Fanmade</button>

			<!-- Alt Art toggle -->
			<input type="checkbox" id="show-alt-art" checked style="display:none;">
			<button type="button" id="btn-show-altart" class="btn btn-xs active" style="margin-left:6px; margin-right:6px;">Alt Art</button>

			<input type="checkbox" id="show-traits-tags" checked style="display:none;">
			<button type="button" id="btn-show-traits" class="btn btn-xs active" style="margin-left:6px;">Traits</button>

			<script>
			(function(){
				var btnF = document.getElementById('btn-show-fanmade');
				var cbF = document.getElementById('show-fanmade-affinity');
				if (btnF && cbF) {
					// set initial visual state
					if (cbF.checked) btnF.classList.add('active'); else btnF.classList.remove('active');
					btnF.addEventListener('click', function(){
						cbF.checked = !cbF.checked;
						try { cbF.dispatchEvent(new Event('change')); } catch(e) { /* old browsers */ }
						btnF.classList.toggle('active');
					});
				}
				var btnT = document.getElementById('btn-show-traits');
				var cbT = document.getElementById('show-traits-tags');
				if (btnT && cbT) {
					if (cbT.checked) btnT.classList.add('active'); else btnT.classList.remove('active');
					btnT.addEventListener('click', function(){
						cbT.checked = !cbT.checked;
						try { cbT.dispatchEvent(new Event('change')); } catch(e) { /* old browsers */ }
						btnT.classList.toggle('active');
					});
				}
				var btnA = document.getElementById('btn-show-altart');
				var cbA = document.getElementById('show-alt-art');
				if (btnA && cbA) {
					if (cbA.checked) btnA.classList.add('active'); else btnA.classList.remove('active');
					btnA.addEventListener('click', function(){
						cbA.checked = !cbA.checked;
						try { cbA.dispatchEvent(new Event('change')); } catch(e) { /* old browsers */ }
						btnA.classList.toggle('active');
					});
				}
			})();
			</script>
	</div>

	<!-- Search Bar -->
	<div class="col-sm-12" style="margin-bottom:10px">
		<input type="text" class="form-control" id="filter-text" placeholder="Find a card or filter the list" tabindex="1">
	</div>


	<!-- Search Bar -->
	<div id="player-cards-filters">

	<div class="col-sm-12">
		<select class="form-control" data-filter="faction_selector" style="display: none;"></select>
	</div>
	<div class="col-sm-12" style="margin-bottom:10px">
      <div class="btn-group btn-group-justified" data-filter="faction_code" data-toggle="buttons"></div>
	</div>


	<div class="col-sm-12" style="margin-bottom:10px">
			<div class="btn-group btn-group-justified" data-filter="type_code" data-toggle="buttons"></div>
  </div>


  </div>


</div>

<!-- Collection Table -->
<div class="row" id="collection">
	<div class="col-sm-12">
		<table class="table table-condensed table-hover" style="margin-bottom:10px">
			<thead>
				<tr>
					<th style="min-width:90px"><a href="#" data-sort="indeck">Quantity</a></th>
					<th style="min-width:180px"><a href="#" data-sort="name">Name</a></th>
					<th class="resources"><a href="#" data-sort="resources" title="Resources">Icons</a></th>
					<th class="cost"><a href="#" data-sort="cost" title="Cost">Cost</a></th>
					<th class="type"><a href="#" data-sort="type_code" title="Type">Type</a></th>
					<th class="faction"><a href="#" data-sort="faction_code" title="Faction">Aspect</a></th>
					<th class="fm_code"><a href="#" data-sort="traits|pack_name" title="fm">Traits</a></th>
				</tr>
			</thead>
			<tbody id="collection-table" class="collection"></tbody>
		</table>
	</div><!-- /.col-sm-12 -->
	<div id="collection-grid" class="col-sm-12"></div>
</div><!-- /.row -->
<!-- Collection Table -->

<style>
.fm_code_yes {
	    display: none !important;
	    /* Fully hide the FM tag visually (keeps element in DOM so :has() still works) */
}
.custom_tag {
    background: rgb(161, 169, 175);
    color: #fff;
    border-radius: 6px;
    padding: 1px 8px;
    font-size: 0.85em;
    margin-left: 6px;
    font-weight: bold;
    display: inline-block;
}
.trait_tag {
    background: #111;
    color: #fff;
    border-radius: 6px;
    padding: 1px 8px;
    font-size: 0.85em;
    margin-left: 6px;
    font-weight: bold;
    display: inline-block;
}

/* Left trim (liser√©) on every row: black by default, blue for fanmade rows */
table.table td:first-child {
	border-left: 4px solid #000; /* black by default */
	padding-left: 8px; /* small spacing so content doesn't sit on the border */
	transition: border-color 180ms ease;
}

/* Fanmade rows: override left border color to blue */
table.table tr:has(.fm_code_yes) td:first-child {
	border-left-color: #1e88e5; /* blue accent for fanmade */
}

/* Show a small two-line "Fan\nMade" SVG AFTER the Name cell for fanmade cards */
table.table tr:has(.fm_code_yes) td:nth-child(2)::after {
	content: '';
	display: inline-block;
	width: 56px; /* larger badge */
	height: 28px;
	margin-left: 4px; /* reduced gap between name and badge */
	vertical-align: middle;
	/* Larger SVG with tighter vertical spacing between 'Fan' and 'Made' */
	background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 36'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%234a90ff'/><stop offset='100%25' stop-color='%231e88e5'/></linearGradient></defs><text x='6' y='12' font-family='Helvetica,Arial,sans-serif' font-size='14' font-weight='700' fill='url(%23g)'>Fan</text><text x='6' y='26' font-family='Helvetica,Arial,sans-serif' font-size='14' font-weight='700' fill='url(%23g)'>Made</text></svg>");
	background-size: contain;
	background-repeat: no-repeat;
}

/* Alt-art rows: override left border color to green */
table.table tr:has(.alt_art_yes) td:first-child {
	border-left-color: #43a047; /* green accent for alt-art */
}

/* Show a small two-line "Alt\nArt" SVG AFTER the Name cell for alt-art cards */
table.table tr:has(.alt_art_yes) td:nth-child(2)::after {
	content: '';
	display: inline-block;
	width: 56px;
	height: 28px;
	margin-left: 4px;
	vertical-align: middle;
	/* Two-line 'Alt' 'Art' SVG in green gradient matching FanMade size/font */
	background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 36'><defs><linearGradient id='g2' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%2341c77a'/><stop offset='100%25' stop-color='%2343a047'/></linearGradient></defs><text x='6' y='12' font-family='Helvetica,Arial,sans-serif' font-size='14' font-weight='700' fill='url(%23g2)'>Alt</text><text x='6' y='26' font-family='Helvetica,Arial,sans-serif' font-size='14' font-weight='700' fill='url(%23g2)'>Art</text></svg>");
	background-size: contain;
	background-repeat: no-repeat;
}

/* Hidden marker element for alt-art detection (kept in DOM but visually hidden) */
.alt_art_yes {
	display: none !important;
}

/* Hide the Aspect (faction) column entirely */
table.table th.faction,
table.table td.faction {
	display: none !important;
}

/* Toggle buttons for fanmade / trait: fixed size and colors */
/* Shared button sizing (slightly larger) */
#btn-show-fanmade, #btn-show-traits, #btn-show-altart {
	display: inline-flex !important;
	justify-content: center;
	align-items: center;
	width: 70px !important; /* slightly narrower */
	height: 28px !important; /* slightly shorter */
	padding: 0 6px !important;
	font-size: 12px !important; /* smaller font */
	line-height: 1 !important;
	border-radius: 4px !important;
	border: none !important;
	box-shadow: none !important;
	vertical-align: middle !important;
}

/* Fanmade button: active = blue (matches left border), inactive = grey */
/* Disabled color shared for both buttons */
:root { --btn-disabled: #9e9e9e; }
#btn-show-fanmade { background-color: var(--btn-disabled) !important; color: #fff !important; }
#btn-show-fanmade.active { background-color: #1e88e5 !important; color: #fff !important; }

/* Trait button: active = black with white text, inactive = grey */
#btn-show-traits { background-color: var(--btn-disabled) !important; color: #fff !important; }
#btn-show-traits.active { background-color: #111 !important; color: #fff !important; }

/* Alt Art button: active = green, inactive = grey */
#btn-show-altart { background-color: var(--btn-disabled) !important; color: #fff !important; }
#btn-show-altart.active { background-color: #43a047 !important; color: #fff !important; }

/* Note: do not override global .btn-xs spacing to avoid changing quantity button sizes */

</style>

